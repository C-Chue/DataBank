Obsidian 發佈服務是為你的筆記提供的付費託管服務。

如果需要了解如何在 Obsidian 中使用該服務，請閱讀[[發佈|這篇筆記]]。

### 隱私

即使使用[[發佈]]服務，你的隱私也是完全自主可控的。你可以自由選擇需要發佈的筆記，無論是幾篇筆記還是整個庫。那些你不想發佈的筆記將永遠不會為外界所知，Obsidian 也不會監測它們，它們將始終安全地儲存在你的本地裝置中。

### 備份

需要注意的是，發佈服務並不是用於備份筆記的。如需備份筆記，請使用那些符合你喜好且穩定的備份方法。Obsidian 的發佈服務將更側重於功能性、易用性以及網站的穩定性。

### 示例

如果你還沒見過使用發佈服務發佈出來的網站，那麼可以看看這個：https://publish.obsidian.md/help （英文）。

### 服務內容

Obsidian 發佈服務作為內建功能可以讓你選用庫中的筆記來直接搭建一個自己的網站。

你可以對這個網站進行個性化設定，比如選擇網站的配色方案、切換可見行寬。

一些網站元件可以在[[發佈|發佈外掛]]中啟用或關閉。對這些選項的修改需要清除快取后才會體現在發佈的網站上，一般5分鐘之內可以完成。

##### 導航欄

開啟這個元件後會在網站左邊顯示一個導航欄，導航欄將顯示所有已發佈的筆記以及包含它們的資料夾。目前正在訪問的頁面會在導航欄中高亮顯示。

##### 搜索欄

在導航欄開啟的前提下你可以開啟搜索欄。搜索欄允許訪問者搜索頁面標題及小標題。目前搜索欄不支援全文內容檢索。

##### 區域性關係圖

開啟后將展示每個頁面的區域性關係圖。這與 Obsidian 中的[[關係圖譜]]使用的是同樣的引擎。

##### 大綱

開啟后將展示目前頁面的大綱。大綱由頁面中的小標題組成，這和 Obsidian 中的[[大綱]]是一樣的。

大綱會以高亮形式提示訪問者目前正在瀏覽頁面的哪一部分。訪問者可以通過點選大綱來在頁面上的內容間快速跳轉。

##### 反向鏈接

開啟后，每頁末尾將顯示一個名為 `Linked to this page` 的部分，這個部分中展示了當前頁面的反向鏈接。如果目前頁面沒有反向鏈接，此部分將不會顯示。

##### 標籤

當訪問者點選頁面上的標籤時，網站會彈出一個視窗，其中列出了所有包含該標籤的頁面。

##### 懸停預覽

開啟這個元件后，訪問者滑鼠懸停在頁面上的鏈接時，會看到一個彈出視窗，視窗中顯示了鏈接的內容。這和[[頁面預覽]]一樣。

##### 自定義 CSS

如果想進一步設定網站的主題，你可以上傳自定義 CSS 檔案。需要注意的是，自定義 CSS 檔案需要命名為 `obsidian.css` 或 `publish.css`，並且放置在網站所在的庫的根目錄下，這樣才能上傳並使用。

這裡建議你使用 `publish.css` 來命名網站的主題檔案，這樣 `obsidian.css` 能用於你本地的主題檔案，從而實現本地主題和網站主題的區分。

##### Favicon

如果想修改網站圖示，你可以上傳 `png` 格式的圖示圖片，並將其以 `favicon-32.png` 或 `favicon-32x32.png` 的形式命名。

你也可以通過上傳檔案 `favicon.ico` 來修改網站圖示。

這些圖示檔案可以存放在庫中的任何位置。目前（2020年）推薦的圖示大小為 `32×32`，`128x128`，`152×152`，`167x167`，`180x180`，`192x192`，以及 `196x196`。

##### 自定義 JS

如果你希望執行自己編寫的 JavaScript 程式碼以提升訪客的瀏覽體驗，或是為自己的網站增加一些功能（如 Discus!、Discourese等），你可以建立一個 `publish.js` 檔案並將其放至於庫的根目錄后將其上傳。需要注意的是，這些指令碼僅對於你網站的訪客生效。

##### 禁止搜索引擎索引

這個選項會為你所有頁面新增 meta noindex 設定，從而使得 Google 這樣的搜索引擎無法索引你的網站。如果你的網站設定了密碼保護，搜索引擎無論如何也無法索引你的網站。

##### Google Analytics

如果你希望為你的網站啟用 Google Analytics，請先確保當地法律法規允許你這麼做。然後，你需要將諸如 `UA-XXXXX-Y` 的追蹤程式碼填入相應的文字框中，隨後你的網站就會被自動追蹤訪問情況。請確保建立的是 Universal Analytics 屬性，而非 Google Analytics 4 屬性。注意，Google Analytics 僅對從你自定義域名來的流量有效。

測試 Google Analytics 的時候，請先關閉瀏覽器上的去廣告擴充套件（比如 uBlock Origin等），這些擴充套件會影響 Google Analytics 的程式碼執行。

另外，發佈服務目前還不能直接與 Google Tag Manage 相容——如果你想使用 Google Tag Manage 而不是 Google Analytics，你可以使用自定義 javascript 設定它。

### 自定義域名

你可以為你的網站設定自定義域名。目前，我們還沒有辦法為你提供 SSL 證書，因此你需要自行尋找啟用 SSL 的伺服器，或者在 CloudFlare 上設定您的網站，他們免費提供 SSL 證書服務。

你也可以將 Obsidian 發佈的內容作為你自己網站的子 URL，比如 `https://my-site.com/my-notes/`。要實現這一點，你必須要有自己的伺服器，並將所有請求代理到我們的伺服器上 `https://publish.obsidian.md/`。

#### CloudFlare 設定

設定自定義域名或子域名的最簡單方法就是使用 [CloudFlare](https://cloudflare.com)，並讓 CloudFlare 管理你的域名。這樣你就可以免費向你的網站新增 SSL，同時確保你的網站在世界任何地方都能被快速訪問。

你只需要新增一個 CNAME 記錄到你的域或子域，將值設定為 `publish-main.obsidian.md`。然後，轉到 SSL/TLS 配置，並將 SSL/TLS 加密模式設定為 `Full`。這將自動配置 SSL/TLS 證書。

一旦完成了 CloudFlare 的配置，你就可以在 Obsidian 中設定你的網站選項，並將 URL 設定為你的域或子域，從而允許我們的伺服器將域與你的網站相關聯。

#### 代理/重定向設定

如果你希望託管自己的 web 伺服器並設定自己的 SSL 加密，則可以選擇此選項。如果你已經託管一個網站在你的域或子域，你也可以通過使用這個選項讓你的網站以特定的 URL 路徑載入你通過 Obsidian 發佈的網站。 

要做到這點，只需簡單地將所有該 URL 路徑下的請求代理到 `https://publish.obsidian.md/serve?url=my-domain.com/my-subpath/...`，並在 Obsidian 的網站設定中配置相同的 URL 路徑。

比如，在 NGINX 中，你可以如下設定：
```nginx
location /my-notes {
	proxy_pass https://publish.obsidian.md/serve?url=my-domain.com/my-notes/;
	proxy_ssl_server_name on;
}
```

在 Apache 的 `.htaccess`，你可以如下設定：


（注意：mod_rewrite 必須開啟，並且你需要配置 [SSLProxyEngine](https://stackoverflow.com/questions/40938148/reverse-proxy-for-external-url-apache))

```htaccess
RewriteEngine  on
RewriteRule    "^my-notes/(.*)$"  "https://publish.obsidian.md/serve?url=my-domain.com/my-notes/$1"  [L,P]
```

如果你使用 Netlify，你可以如下設定：

```
[[redirects]]
  from = "https://my-domain.com/my-notes/*"
  to = "https://publish.obsidian.md/serve?url=my-domain.com/my-notes/:splat"
  status = 200
  force = true
```

#### 自定義域名設定之後的問題

你設定了自定義域名，但如果你以前從 `https://publish.obsidian.md/slug` 訪問過你的網站的話，你可能需要清除瀏覽器快取（比如字型、圖片或訪問密碼等）使其能正常訪問。這是由於現代瀏覽器強加的跨域安全限制導致的。好訊息是，如果你只讓你的訪問者使用自定義域名，他們就永遠不會遇到這個問題。

### 未來計劃

發佈服務仍處於早期階段，以下是我們計劃新增的一些功能：

- 完整的自定義域名支援（提供 SSL 證書）
- 全文檢索
- 更多內建主題

如果你對發佈服務有任何建議或意見，請通過在[論壇](https://forum.obsidian.md/)發帖讓我們知道。

### 價格

關於發佈服務的價格，請看[我們的價格說明](https://obsidian.md/pricing)。

### 技術細節

Obsidian 發佈服務使用 CloudFlare 作為 CDN（內容分發網路）來在全球範圍內分發你的網站，以實現網站的更快訪問。其原理是在200多個數據中心快取你網站的檔案副本，從而保證你的網站在任何地方都有較快的載入速度。

但這意味著當你修改網站設定、發佈或取消發佈內容時，訪問者可能無法立即看到最新版本的網站。目前，我們將網站快取設定為一個小時，超過一個小時後就必須重新驗證，從而確保所訪問版本是最新的。

如果你剛剛發佈了一些內容，但是看到的仍然是網站的舊版本，你可以嘗試按住重新載入按鈕並在下拉菜單中選擇 `hard reload` 來執行 `hard refresh`。如果這個方法不行，你還可以嘗試清除瀏覽器快取或使用開發者工具禁用快取。

---

### 相關資訊

你可以閱讀[[發佈]]來獲取更多關於如何發佈筆記的資訊。
