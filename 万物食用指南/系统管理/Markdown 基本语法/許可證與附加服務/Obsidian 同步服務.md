Obsidian 同步服務是一項能讓你在各裝置間同步筆記的收費服務。

### Obsidian 同步服務的工作原理

Obsidian 同步服務的工作原理非常簡單：當你將多個本地庫連線到同一個遠端庫時，任意一個本地庫的修改都會通過遠端庫擴散到其他本地庫中，從而實現不同本地庫內容的一致。當然，你也可以通過設定忽略一些改動。

### 功能

目前，Obsidian 同步服務擁有以下功能：

- 端到端加密
- 整合到 Obsidian 客戶端中的版本歷史
- 回收站（檢視雲端的刪除歷史，並可撤銷刪除）
- 同步配置檔案（同步主要設定、主題、CSS 程式碼片段、第三方外掛設定等內容）
- 選擇性同步
	- 忽略指定資料夾
	- 選擇需要同步的附件型別（圖片檔案、視訊檔案、音訊檔案、PDF 以及其他不被 Obsidian 支援的檔案型別）
- 多個遠端庫間的無縫切換

未來，Obsidian 同步服務還會有：

- 庫分享功能

### 打開同步外掛

在 v0.9.21 或更高版本的 Obsidian 中，你可以在 `設定` -> `核心外掛` 中打開同步外掛。

### 設定遠端庫

需要注意的是，我們並不推薦第三方同步服務與 Obsidian 的同步功能一起使用。見[[#第三方同步服務]]部分。

使用 Obsidian 同步服務的第一步是建立一個遠端庫。遠端庫將以加密方式將你本地的筆記數據儲存在雲端。

建立遠端庫的方法很簡單，`設定` -> `同步` -> `選擇遠端庫` -> `選擇` -> `新建遠端庫` 即可。

當你建立好了遠端庫后，你可以立即將目前的本地庫與該遠端庫連線（點選遠端庫后的 `連線` 按鈕即可）。

連線好遠端庫后，Obsidian 會詢問你是否立即開始同步。當然，在同步前，你還可以配置需要忽略的資料夾。

##### 設定加密密碼

預設情況下，你需要為自己的遠端庫設定一個加密密碼。這個密碼將用來對你的筆記數據進行加密、解密。因此它非常重要。

當你新建遠端庫時，Obsidian 會要求你提供加密密碼。==如果你忘記或遺失了這個密碼，那麼你儲存在雲端的筆記數據將永遠無法解密、使用。我們無法幫你解密這些數據。==但即便這樣，你本地的筆記數據也不會受影響。

你也可以選擇關閉 `自定義端到端加密密碼功能`，這樣你就沒必要記住密碼了。我們會採用相應的加密方案來保證你筆記數據的安全。這是一個方便且安全的選擇。

### 確認同步狀態

連線遠端庫后，你可以通過檢視底部狀態列的圖示來確認同步狀態。如果想了解更多資訊，請將滑鼠懸停在同步狀態圖示上。

小技巧：點選同步狀態圖示可以快速打開同步設定

### 版本歷史

編輯筆記時，同步服務會每十秒儲存一次筆記，從而形成筆記的版本歷史。==同步服務僅記錄筆記的版本歷史，庫中的附件則不會生效。==

在檔案列表中選中某個檔案，點選右鍵，你就可以檢視該筆記的版本歷史。當然，你也可以在筆記面板右上角的 `更多選項` 菜單中檢視目前筆記的版本歷史。

打開版本歷史視窗，在左邊的列表中選中某個版本后，點選 `恢復此版本` 按鈕，你就可以將目前筆記恢復到該版本。

### 刪除檔案

當你刪除了某個檔案后，你可以在 `設定` -> `同步` -> `已刪除檔案` -> `檢視` 中找到它。

點選刪除檔案可以打開該檔案的版本歷史。此時，你可以選擇是否將檔案恢復到之前的某個版本。

### 選擇性同步

同步時，你可以排除一些資料夾以及特定型別的檔案。==需要注意的是，當你改變選擇性同步的設定后，這種改變僅影響未來的同步，已同步的檔案則不會被影響。也就是說，即便你想忽略特定型別的檔案，該型別已同步的檔案也不會被 Obsidian 刪除。所以，請在同步前好好思考這個設定。==

##### 排除資料夾

要讓某個資料夾不被同步，你需要在 `設定` -> `同步` -> `需要排除的資料夾` -> `管理` 中進行設定。

設定好后，無論你對這些資料夾進行怎樣的修改，Obsidian 都不會將修改上傳、下載。

#### 同步的檔案型別

你可以在 `設定` -> `同步` -> `選擇性同步` 中選擇你想同步的檔案型別（圖片、音訊、視訊、PDF 以及其他不被 Obsidian 支援的檔案型別）。

### 同步配置檔案

除了筆記和附間，Obsidian 還允許你同步庫的配置檔案。這些配置檔案包括：

- Obsidian 的主要設定，比如編輯器、檔案與鏈接等方面的設定。
- 外觀設定，比如基礎顏色、目前應用的主題、開啟的 CSS 程式碼片段等設定資訊。
- 主題與 CSS 程式碼片段，即那些儲存在庫中的主題和 CSS 程式碼片段檔案。
- 快捷鍵。
- 核心外掛的啟用情況，即核心外掛的開啟資訊。
- 核心外掛的設定資訊。
- 第三方外掛啟用情況，即第三方外掛開啟資訊。
- 已下載、安裝的第三方外掛，包括外掛本身及其設定檔案。

你可以選擇同步哪些配置檔案，從而讓你在不同裝置上都有最好的使用體驗。

需要注意的是，同步配置檔案不意味著其他裝置上的 Obsidian 能自動應用最新的配置檔案——配置檔案只有重啟 Obsidian、或重新載入目前庫才能生效。這點對於移動端來說並不是什麼問題，畢竟你每次打開移動端基本都是在重新啟動 Obsidian。

同步功能並不會讓不同名稱的配置資料夾相互覆蓋。你可以利用這個特點來建立不同的同步配置資料夾。一種常見的用法是，為移動端和桌面端設立不同的同步配置資料夾。

#### 配置檔案版本歷史

如果配置出現了問題，或是你丟失了部分設定資訊，你可以在同步外掛的 `配置檔案版本歷史`中恢復這些設定。

### 第三方同步服務

如果你已經通過 Obsidian 同步服務在某些裝置間同步某個庫，我們並不推薦你再使用如 Dropbox、Google Drive、OneDrive、iCloud、堅果云之類的第三方同步服務在這些裝置間同時同步它。因為這樣會造成一些問題，比如衝突、重複檔案，更壞的情況下還會使檔案損壞。

如果你已經這麼做了，那麼可能會出現以下情況：

- 如果 Obsidian 同步服務「打敗」了第三方同步服務、優先將筆記同步到本地，那麼第三方同步服務將無法識別新到的筆記，從而將其視為衝突的檔案，產生檔案副本。
- 如果第三方同步服務「打敗」了 Obsidian 同步服務、優先將筆記同步到本地，Obsidian 同步服務會嘗試將新到筆記與舊筆記合併。這可能丟失部分對該筆記的修改（通常會丟失最後修改的幾個字元）

因此，不要同時使用 Obsidian 同步服務與第三方同步服務。如果你想通過第三方同步服務來備份筆記，你可以僅在主力筆記裝置上開啟第三方服務，而不要在其他裝置上開啟第三方同步服務。即在主力裝置上用第三方同步服務備份筆記，用 Obsidian 同步服務將筆記同步至其他裝置。這樣就能避免第三方同步服務與 Obsidian 同步服務的競爭。

### 疑問與解答

##### 什麼是端到端加密？

端到端加密指的是當數據離開你的裝置后就立即被演算法加密，當且僅當數據回到你的裝置時才能通過你的金鑰進行解密的模式。

因此，我們沒有讀取你筆記數據的能力，網路供應商等潛在的竊聽者也不會存在。

除非伺服器數據完全泄露（這種事件發生的概率幾乎為 0），否則你的數據將一直處於加密狀態，沒有人能在不知道你金鑰的情況下解密你的數據。

##### 我可以擁有幾個遠端庫？

每個購買了 Obsidian 同步服務的賬號最多能擁有 5 個遠端庫。

##### 版本歷史將儲存多久？

版本歷史最多可以儲存一年。

##### 遠端庫的容量是多大？

目前，每個遠端庫的容量限制為 10 GB（這包括版本歷史佔用的容量）

##### 我的數據是在本地加密嗎？

並不是，筆記數據並不會在本地加密。所以如果你想在本地對筆記進行加密以防他人在使用你的裝置時發現你的隱私，你可以使用硬碟加密工具。

##### 訂閱到期后我的筆記數據會在伺服器儲存多久？

訂閱到期后，筆記數據（包括版本歷史）會在伺服器上保留一個月。

只要你在一個月內及時續訂，這不會對你的使用有任何影響。

##### 我是否能將 Obsidian 同步服務作為筆記數據的備份手段？

我們設計同步服務時，更將其視為多裝置間數據同步的解決方案，而非備份的解決方案。

但因為版本歷史功能的存在，同步服務確實能提供一些備份的功能。但是，我們仍推薦你使用專業的備份解決方案。

另外，同步服務仍處於測試階段。因此我們也強烈推薦你通過其他方案備份筆記數據，以防同步服務的 bug 或小故障。

##### 我是否應該使用自定義加密功能？

如果你需要最高級別的安全與隱私保障，那麼我們推薦你使用自定義加密功能。自定義加密密碼可以保證任何人都不能讀取你的筆記數據。

當然，使用我們的內建方案確實更方便，並且你也不會因為忘記或丟失密碼而導致數據永遠不可用。

無論你是否啟用自定義加密功能，本地數據都不會受到影響。你可以通過合適的方式備份本地的筆記數據。

##### 端到端加密很安全嗎？

我們使用工業級的 AES-256 演算法來加密你的數據。AES-256 是軍用級別的加密方案，其已被線上支付業務廣泛使用。

如果你對加密演算法感興趣，這是同步服務加密方法的細節資訊：

- Key derivation function used: scrypt with salt
- Encryption algorithm used: AES-256 using GCM

##### `vault limit exceeded` 錯誤是什麼意思？

每個遠端庫的最大容量為 10 GB。當你的庫超過這個大小時，Obsidian 就會提示這個錯誤。需要注意的是，庫中的附件以及版本歷史一樣會佔用庫容量。所以，即便庫中筆記少於 10 GB，遠端庫也還是有超限的可能。

當你看到這個錯誤提示后，Obsidian 將幫助你查詢庫中最大的檔案，從而減小遠端庫的體積。你只需到同步外掛的設定中尋找 "庫大小超標" 選項即可。
